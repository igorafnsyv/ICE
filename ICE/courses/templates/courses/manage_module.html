<h2>Modify Module</h2>

<script>

let previousElement;

function dragOver(e) {
  if (isBefore(previousElement, e.target))
    e.target.parentNode.insertBefore(previousElement, e.target);
  else
    e.target.parentNode.insertBefore(previousElement, e.target.nextSibling);
}

function dragStart(e) {
  e.dataTransfer.effectAllowed = "move";
  e.dataTransfer.setData("text/plain", null); 
  previousElement = e.target;
}

function isBefore(elementOne, elementTwo) {
  if (elementTwo.parentNode === elementOne.parentNode)
    for (let currentElement = elementOne.previousSibling; currentElement && currentElement.nodeType !== 9; currentElement = currentElement.previousSibling)
      if (currentElement === elementTwo)
        return true;
  return false;
}
</script>
<form action="" method="post">
    Change Title: <input type="text", name="title">
    <br>
    <ul>
        {% for component in all_components %}
            <li id = "{{ component.id }}" draggable="true" ondragover="dragOver(event)" ondragstart="dragStart(event)">{{ component.title }}</li>
        {% endfor %}
    </ul>
    <button type="submit" onclick="return savePosition();">Submit</button>
</form>

<script>
    function savePosition() {
        let elements = document.getElementsByTagName('li');
        for (var i = 0; i < elements.length; i++) {
          let xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange=function() {
            if (this.readyState == 4 && this.status == 200) {
                console.log("sent");
            }
          };
          xhttp.open("GET", "/courses/module_manage/" + elements[i].id +'/' + i, false);
          xhttp.send();
        }
        return false;
    }
</script>